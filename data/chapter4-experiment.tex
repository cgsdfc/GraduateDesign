% !Mode:: "TeX:UTF-8"
% Author: Zhengxi Tian
% Email: zhengxi.tian@hotmail.com

\chapter{实验结果与讨论}\label{ch:experiment}
本章从系统层面得分，句子层面得分和定性分析三个方面展示了实验的数据与结论。

\section{系统层面得分}\label{sec:system_scores}
图~\ref{tab:systemScoresAll}~展示了各个模型在不同数据集上测定的各种指标的系统层面得分，
加粗的得分是三个系统中的最优者。
从表中的数据来看，在LSDSCC上的最优模型是HRED，
在OpenSubtitles上的最优模型是VHRED，
在Ubuntu上的最优模型是HRED，它在9个指标中取得了最优，但是LSTM也在6个指标中取得了最优。

\input{data/system_scores.tex}

\section{句子层面得分}\label{sec:utterance_scores}
我们还从句子层面得分方面进行了分析。
因为模型生成的句子$u$可以看做一个句子空间$U$上的随机变量，而指标是一个确定的函数$f_{s}$，
所以可以把句子层面的得分看做一个随机变量$\lambda_u = f_{s}(u)$。
于是我们便可以用描述统计学（Descriptive Statistics）和统计推断断（Statistical Inference）
的方法来分析指标在句子水平的情况，包括单变量和双变量的方法，以及各种统计数据。
以下所有图片均使用seaborn绘制\footnote{\url{http://seaborn.pydata.org/}}。

\subsection{指标的概率分布}\label{subsec:metric_distribution}
我们绘制了各种指标的句子层面得分的单变量分布（Univariate Distribution）。
为了便于从图像上比较各种指标的分布特征，我们对数值作了归一化（Scaling）处理，使数据的平均值为0，标准差为1：
\begin{align}
    x' = \frac{x - \mu}{\sigma}
\end{align}
我们绘制了在所有$(m, d, s)$的组合上绘制了分布图，并发现各种指标的分布在不同的数据集和模型的组合上
有着相似的形状。为了使读者能迅速检阅所有指标的分布，我们在正文中展示的是$(\text{HRED}, \text{OpenSubtitles})$
上各项指标的分布。请参阅附录~\ref{ch:metric_dist}~查看所有的组合上的分布。

\input{data/distplot_group/BLEU.tex}
图~\ref{fig:BLEU_dist}~是BLEU的N取1到4时的分布图。
由于加入了平滑处理，所以大部分得分都有非零数值，
然而正如\cite{HowNot}所说，大部分句子的得分非常低，
在图像上的反映是，在均值附近集中了大量的概率质量（Probability Mass）。
得分较高和较低的句子非常少，几乎没有。
比其更高的N值，Unigram匹配是最容易得到的，所以BLEU-1在
均值的右边有一个比较低矮的分布，并且峰值对应的横坐标偏离了均值0，
这说明有相当一部分句子的得分高于均值。
而低于均值的部分出现了一个高峰，说明也有大量句子得分低于均值，
但总体来说，得分高于均值的句子更多。
BLEU-2至4的分布都非常相似，峰值的横坐标比BLEU-1更接近均值。
从总体上来说，BLEU的分布形状十分尖锐，大量句子集中在均值或略高于均值附近，
图像不对称， 峰值比高斯分布的峰值$1 / \sqrt{2 \pi} \approx 0.4$高。

\input{data/distplot_group/ADEM_EB.tex}
图~\ref{fig:ADEM_EB_dist}~是基于词嵌入的指标和ADEM指标的分布图。
因为ADEM可以看做是一种更高级的词嵌入指标，所以把它和其他词嵌入指标并列。
四个图像均呈钟型曲线，峰值非常接近0.4，峰值的横坐标则非常接近0。
ADEM曲线显示出几乎完美的对称，Greedy曲线的对称度次之，
Average曲线向右边偏移，Extrema曲线向左边偏移。
ADEM和词嵌入指标有相似之处。
从句子向量的组合方式来看，
Average的组合方法是平均值，Extrema的组合方法是极端值，
而ADEM的则使用了预训练的VHRED的编码器。
与其他词嵌入指标不同的是，ADEM考虑了上下文的影响，
用神经网络对上下文，响应和参考三者加权，
并且显式的优化了和人类评价的相关性，
可见ADEM采用的机制更为复杂。
Lowe在\cite{ADEM}中指出，ADEM倾向于保守打分，
即人类评价给高分的句子，ADEM倾向于给稍低的分数。
从ADEM的曲线可以从某种意义上验证这一点，
得分高于平均值的句子与得分低于平均值的句子几乎一样多，
说明它不倾向于打高分或者低分。

\input{data/distplot_group/ROUGE.tex}
图~\ref{fig:ROUGE_dist}~是ROUGE系列指标的分布图。
从曲线的形状来看，大致可分为两类：
ROUGE-1，ROUGE-L，ROUGE-W是一类，
ROUGE-2，ROUGE-3，ROUGE-4是一类。
ROUGE-2这类图像的特点是几乎所有句子的得分都集中在均值，
除此之外没有其他得分。
因为我们没有对ROUGE指标做任何平滑处理，
我们猜想原因是除了极个别句子外，其他句子都得了零分。
这表明ROUGE-N指标当$N > 1$时捕捉不到任何n-gram重叠。
与BLEU不同的是，ROUGE-N不考虑$n < N$的其他n-gram，
导致它更容易给出0分。
另一方面，ROUGE-1类指标更像是BLEU-1指标的噪化版本，
它们都是双峰曲线，而且第一个峰值对应的点$(x_1, y_1)$和
第二个峰值对应的点$(x_2, y_2)$都有相似的坐标。
读者可以验证以下取值范围对BLEU-1，ROUGE-1，ROUGE-L，ROUGE-W都成立：
\begin{align}
    -1 < x_1 < 0, 1 < y_1 < 1.5 \\
    0 < x_2 < 2, 0 < y_2 < 0.5
\end{align}
造成上述现象的原因是，所有的响应和参考基本上没有$N > 1$的n-gram重叠，
因此基于最长公共子序列和它的加权版本的匹配都退化成了Unigram匹配，
相应的，ROUGE-1，ROUGE-L，ROUGE-W都退化成了BLEU-1。

图~\ref{fig:Other_dist}~是Distinct-N，METEOR和#words的分布图。
\input{data/distplot_group/Other.tex}


% -- Conclusion -- %
中心极限定理（Central Limit Theorems）表明：大量独立随机变量的叠加近似于高斯分布。
因为各位人类评价员之间的评价是独立的，我们假设当句子足够多时，句子层面的人类评价近似于高斯分布。
据此我们认为，句子层面得分的分布接近高斯分布是一个指标和人类评价具有较高相关性的前提条件之一。
从上述各个指标的分布来看， ADEM和词嵌入指标具有很大的潜力。

\subsection{不同指标的相关性分析}\label{subsec:metric_correlation}

\section{定性分析}\label{sec:qualitative_analysis}

\section{结果与讨论}\label{sec:result_and_discussion}

\section{本章小结}\label{sec:experiment_conclusion}
